%% source:
%% https://github.com/trucomanx/env-theorem-simplebox


\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{env-theorem-simplebox}[2022/05/21 Package with macros to the math enviroment]


\RequirePackage[most]{tcolorbox}
\RequirePackage{xcolor}
\RequirePackage[explicit]{titlesec} %% sections
\RequirePackage{titletoc} %% TOC
\RequirePackage{xparse} %%\ExplSyntaxOn
\RequirePackage{pifont} %% \ding{111}
\usepackage{ifthen}


% Options
%\DeclareOption{red}{\renewcommand{\wordcolour}{sharelatexcolour}}
\DeclareOption*{\PackageWarning{env-theorem-simplebox}{The option ‘\CurrentOption’ is current unknown}}
\ProcessOptions\relax


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Macros 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% defining variable




\newlength{\EnvTheoremSimpleBoxPostPic}
\setlength{\EnvTheoremSimpleBoxPostPic}{1ex}
\newcommand{\SetEnvTheoremSimpleBoxPostPic}[1]{\setlength{\EnvTheoremSimpleBoxPostPic}{#1}}%

\newlength{\EnvTheoremSimpleBoxThickness}
\setlength{\EnvTheoremSimpleBoxThickness}{1pt}
\newcommand{\SetEnvTheoremSimpleBoxThickness}[1]{\setlength{\EnvTheoremSimpleBoxThickness}{#1}}%

\newlength{\EnvTheoremSimpleBoxLeftPadding}
\setlength{\EnvTheoremSimpleBoxLeftPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleBoxLeftPadding}[1]{\setlength{\EnvTheoremSimpleBoxLeftPadding}{#1}}%

\newlength{\EnvTheoremSimpleBoxRightPadding}
\setlength{\EnvTheoremSimpleBoxRightPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleBoxRightPadding}[1]{\setlength{\EnvTheoremSimpleBoxRightPadding}{#1}}%

\newlength{\EnvTheoremSimpleBoxTopPadding}
\setlength{\EnvTheoremSimpleBoxTopPadding}{2ex}
\newcommand{\SetEnvTheoremSimpleBoxTopPadding}[1]{\setlength{\EnvTheoremSimpleBoxTopPadding}{#1}}%

\newlength{\EnvTheoremSimpleBoxBottomPadding}
\setlength{\EnvTheoremSimpleBoxBottomPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleBoxBottomPadding}[1]{\setlength{\EnvTheoremSimpleBoxBottomPadding}{#1}}%

\newlength{\EnvTheoremSimpleBoxFrameArc}
\setlength{\EnvTheoremSimpleBoxFrameArc}{8pt}
\newcommand{\SetEnvTheoremSimpleBoxFrameArc}[1]{\setlength{\EnvTheoremSimpleBoxFrameArc}{#1}}%


%% Define before space
\newcommand{\EnvTheoremSimpleBoxBeforeSpace}{0pt}
\newcommand{\SetEnvTheoremSimpleBoxBeforeSpace}[1]{\renewcommand{\EnvTheoremSimpleBoxBeforeSpace}{#1}}%

%% Define after space
\newcommand{\EnvTheoremSimpleBoxAfterSpace}{-3.5ex}
\newcommand{\SetEnvTheoremSimpleBoxAfterSpace}[1]{\renewcommand{\EnvTheoremSimpleBoxAfterSpace}{#1}}%

%% Define showed name of enviroment
\newcommand{\EnvTheoremSimpleBoxPreTitle}{Theorem}
\newcommand{\SetEnvTheoremSimpleBoxPreTitle}[1]{\renewcommand{\EnvTheoremSimpleBoxPreTitle}{#1}}%

%% Define the frame color of enviroment
\newcommand{\EnvTheoremSimpleBoxFrameColor}{green!50!black}
\newcommand{\SetEnvTheoremSimpleBoxFrameColor}[1]{\renewcommand{\EnvTheoremSimpleBoxFrameColor}{#1}}%

%% Define the shadow color of enviroment
\newcommand{\EnvTheoremSimpleBoxShadowColor}{black}
\newcommand{\SetEnvTheoremSimpleBoxShadowColor}[1]{\renewcommand{\EnvTheoremSimpleBoxShadowColor}{#1}}%

%% Define the backaground body text color
\newcommand{\EnvTheoremSimpleBoxBackColor}{green!5!white}
\newcommand{\SetEnvTheoremSimpleBoxBackColor}[1]{\renewcommand{\EnvTheoremSimpleBoxBackColor}{#1}}%

%% Define The title body color 
\newcommand{\EnvTheoremSimpleBoxTitleColor}{green!50!black}
\newcommand{\SetEnvTheoremSimpleBoxTitleColor}[1]{\renewcommand{\EnvTheoremSimpleBoxTitleColor}{#1}}%

%% Define The title back  color 
\newcommand{\EnvTheoremSimpleBoxTitleBackColor}{blue!10!white}
\newcommand{\SetEnvTheoremSimpleBoxTitleBackColor}[1]{\renewcommand{\EnvTheoremSimpleBoxTitleBackColor}{#1}}%

%% Define The title back  color 
\newcommand{\EnvTheoremSimpleBoxTitleFrameColor}{blue!50!white}
\newcommand{\SetEnvTheoremSimpleBoxTitleFrameColor}[1]{\renewcommand{\EnvTheoremSimpleBoxTitleFrameColor}{#1}}%

%% Define the tile font 
\newcommand{\EnvTheoremSimpleBoxTitleFont}{\bfseries}
\newcommand{\SetEnvTheoremSimpleBoxTitleFont}[1]{\renewcommand{\EnvTheoremSimpleBoxTitleFont}{#1}}%

%% Define the image of pretitle
\newcommand{\EnvTheoremSimpleBoxImage}{{\color{green!50!black}\ding{113}}}
\newcommand{\SetEnvTheoremSimpleBoxImage}[1]{\renewcommand{\EnvTheoremSimpleBoxImage}{#1}}%


%% Warning: These variables dont have \Set... method
\newcommand{\EnvTheoremSimpleBoxListingExt}{EnvTheoremSimpleBoxListingExt}
\newcommand{\EnvTheoremSimpleBoxTocEntryFormat}{}


%
\newcommand{\EnvTheoremSimpleBoxPicWidth}{4ex}



%% Crea una macro que capitaliza la primera letra
\ExplSyntaxOn
\NewExpandableDocumentCommand \FirstLetterUppercase { O{} m }
  { \text_titlecase:nn {#1} {#2} }
\ExplSyntaxOff


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definir un estilo base para el tcolorbox sin sombra
\tcbset{
  EnvTheoremSimpleBoxStyle/.style={
    breakable,
    enhanced
  }
}


\newcommand{\SetEnvTheoremSimpleBoxEnableSolidShadow}{
\tcbset{EnvTheoremSimpleBoxStyle/.append style={shadow={1mm}{-1mm}{0mm}{\EnvTheoremSimpleBoxShadowColor}     }}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Create a new counter that will follow tcolorbox's numbering
%% Create a new counter that will follow tcolorbox's numbering
\newcounter{theoremCounter}[section]
\renewcommand*{\thetheoremCounter}{\noexpand\thesection.\noexpand\arabic{theoremCounter}}

\newtcolorbox[list inside=\EnvTheoremSimpleBoxListingExt,list type=\EnvTheoremSimpleBoxListingExt,auto counter,number within=section]%
{theorem}%
[1][]%
{
EnvTheoremSimpleBoxStyle,
colback=\EnvTheoremSimpleBoxBackColor,
colframe=\EnvTheoremSimpleBoxFrameColor,
%
before={\vspace{\EnvTheoremSimpleBoxBeforeSpace}},
after={\vspace{\EnvTheoremSimpleBoxAfterSpace}},
%
left=\EnvTheoremSimpleBoxLeftPadding,
right=\EnvTheoremSimpleBoxRightPadding,
top=\EnvTheoremSimpleBoxTopPadding,
bottom=\EnvTheoremSimpleBoxBottomPadding,
%
%shadow={1mm}{-1mm}{0mm}{\EnvTheoremSimpleBoxShadowColor}%
drop shadow=\EnvTheoremSimpleBoxShadowColor,
enlarge top by=\topsep,
overlay unbroken and first={
    \node[xshift=10pt,thick,draw=\EnvTheoremSimpleBoxTitleFrameColor,fill=\EnvTheoremSimpleBoxTitleBackColor,rounded corners,anchor=west] at (frame.north west) %
    {%
      %\ifdefempty{\tcbtitletext} 
      \if#1\@empty\relax\relax
            %\addtocounter{theoremCounter}{-1}\refstepcounter{theoremCounter}%
            \EnvTheoremSimpleBoxImage
            \hspace{\EnvTheoremSimpleBoxPostPic}%
            \textcolor{\EnvTheoremSimpleBoxTitleColor}%
            {\EnvTheoremSimpleBoxTitleFont\EnvTheoremSimpleBoxPreTitle\;\thetcbcounter:} %
            %\refstepcounter{theoremCounter}
      \else
            %\addtocounter{theoremCounter}{-1}\refstepcounter{theoremCounter}%
            \EnvTheoremSimpleBoxImage
            \hspace{\EnvTheoremSimpleBoxPostPic}%
            \textcolor{\EnvTheoremSimpleBoxTitleColor}%
            {\EnvTheoremSimpleBoxTitleFont\EnvTheoremSimpleBoxPreTitle\;\thetcbcounter\;-- #1:} %
            %\refstepcounter{theoremCounter}
      \fi
    };
}
%title={#1},
%detach title,
%
coltitle=\EnvTheoremSimpleBoxTitleColor,
fonttitle=\EnvTheoremSimpleBoxTitleFont,
%
leftrule=\EnvTheoremSimpleBoxThickness,
toprule=\EnvTheoremSimpleBoxThickness, 
rightrule=\EnvTheoremSimpleBoxThickness, 
bottomrule=\EnvTheoremSimpleBoxThickness,
%
arc=\EnvTheoremSimpleBoxFrameArc,
code={
        \if#1\@empty\relax\relax
            \tcbset{list text={ \FirstLetterUppercase{\EnvTheoremSimpleBoxPreTitle}  }}
        \else
            \tcbset{list text={#1}}
        \fi
    %
    %
        \tcbset{before upper={\addtocounter{theoremCounter}{-1}\refstepcounter{theoremCounter}%
        \refstepcounter{theoremCounter}}}
    },
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% List of type 
%% Usar con:  \tcblistof[\section*]{\EnvTheoremSimpleBoxListingExt}{Lista de frases}
%%
\titlecontents{\EnvTheoremSimpleBoxListingExt}[2.00cm] %% Indentation %% left
{\EnvTheoremSimpleBoxTocEntryFormat} %% Spacing and font options for sections %% above code
{\contentslabel[{\thecontentslabel}]{1.45cm}} %% Section number %% numbered-entry-format % {\thetcbcounter}%
{} %% numberless-entry-format
{\ \titlerule*[.5pc]{.}\;\color{black}\thecontentspage} %% filler-page-format 
[] %% separator



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\makeatletter
%\newcommand{\ttll@\EnvTheoremSimpleBoxListingExt}{-1000}
%\makeatother
%% To next warning
%% Package titletoc Warning: Unknown TOC type EnvTheoremSimpleBoxListingExt. I'll set it for you with(titletoc)                level -1000. on input line 1.
