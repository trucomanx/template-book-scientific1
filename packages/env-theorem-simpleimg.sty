%% source:
%% https://github.com/trucomanx/env-theorem-simpleimg


\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{env-theorem-simpleimg}[2022/05/21 Package with macros to the math enviroment]


\RequirePackage[most]{tcolorbox}
\RequirePackage{xcolor}
\RequirePackage[explicit]{titlesec} %% sections
\RequirePackage{titletoc} %% TOC
\RequirePackage{xparse} %%\ExplSyntaxOn
\RequirePackage{pifont} %% \ding{111}


% Options
%\DeclareOption{red}{\renewcommand{\wordcolour}{sharelatexcolour}}
\DeclareOption*{\PackageWarning{env-theorem-simpleimg}{The option ‘\CurrentOption’ is current unknown}}
\ProcessOptions\relax


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Macros 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% defining variable

\newlength{\EnvTheoremSimpleImgPostPic}
\setlength{\EnvTheoremSimpleImgPostPic}{1ex}
\newcommand{\SetEnvTheoremSimpleImgPostPic}[1]{\setlength{\EnvTheoremSimpleImgPostPic}{#1}}%

\newlength{\EnvTheoremSimpleImgThickness}
\setlength{\EnvTheoremSimpleImgThickness}{1pt}
\newcommand{\SetEnvTheoremSimpleImgThickness}[1]{\setlength{\EnvTheoremSimpleImgThickness}{#1}}%

\newlength{\EnvTheoremSimpleImgLeftPadding}
\setlength{\EnvTheoremSimpleImgLeftPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleImgLeftPadding}[1]{\setlength{\EnvTheoremSimpleImgLeftPadding}{#1}}%

\newlength{\EnvTheoremSimpleImgRightPadding}
\setlength{\EnvTheoremSimpleImgRightPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleImgRightPadding}[1]{\setlength{\EnvTheoremSimpleImgRightPadding}{#1}}%

\newlength{\EnvTheoremSimpleImgTopPadding}
\setlength{\EnvTheoremSimpleImgTopPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleImgTopPadding}[1]{\setlength{\EnvTheoremSimpleImgTopPadding}{#1}}%

\newlength{\EnvTheoremSimpleImgBottomPadding}
\setlength{\EnvTheoremSimpleImgBottomPadding}{1ex}
\newcommand{\SetEnvTheoremSimpleImgBottomPadding}[1]{\setlength{\EnvTheoremSimpleImgBottomPadding}{#1}}%

%% Define before space
\newcommand{\EnvTheoremSimpleImgBeforeSpace}{0pt}
\newcommand{\SetEnvTheoremSimpleImgBeforeSpace}[1]{\renewcommand{\EnvTheoremSimpleImgBeforeSpace}{#1}}%

%% Define after space
\newcommand{\EnvTheoremSimpleImgAfterSpace}{0pt}
\newcommand{\SetEnvTheoremSimpleImgAfterSpace}[1]{\renewcommand{\EnvTheoremSimpleImgAfterSpace}{#1}}%

%% Define showed name of enviroment
\newcommand{\EnvTheoremSimpleImgPreTitle}{THEOREM}
\newcommand{\SetEnvTheoremSimpleImgPreTitle}[1]{\renewcommand{\EnvTheoremSimpleImgPreTitle}{#1}}%

%% Define the frame color of enviroment
\newcommand{\EnvTheoremSimpleImgFrameColor}{black}
\newcommand{\SetEnvTheoremSimpleImgFrameColor}[1]{\renewcommand{\EnvTheoremSimpleImgFrameColor}{#1}}%

%% Define the backaground body text color
\newcommand{\EnvTheoremSimpleImgBackColor}{white}
\newcommand{\SetEnvTheoremSimpleImgBackColor}[1]{\renewcommand{\EnvTheoremSimpleImgBackColor}{#1}}%

%% Define The title body color 
\newcommand{\EnvTheoremSimpleImgTitleColor}{green!50!black}
\newcommand{\SetEnvTheoremSimpleImgTitleColor}[1]{\renewcommand{\EnvTheoremSimpleImgTitleColor}{#1}}%

%% Define the tile font 
\newcommand{\EnvTheoremSimpleImgTitleFont}{\bfseries}
\newcommand{\SetEnvTheoremSimpleImgTitleFont}[1]{\renewcommand{\EnvTheoremSimpleImgTitleFont}{#1}}%

%% Define the image of pretitle
\newcommand{\EnvTheoremSimpleImgImage}{{\color{green!50!black}\ding{113}}}
\newcommand{\SetEnvTheoremSimpleImgImage}[1]{\renewcommand{\EnvTheoremSimpleImgImage}{#1}}%


%% Warning: These variables dont have \Set... method
\newcommand{\EnvTheoremSimpleImgListingExt}{EnvTheoremSimpleImgListingExt}
\newcommand{\EnvTheoremSimpleImgTocEntryFormat}{}


%
\newcommand{\EnvTheoremSimpleImgPicWidth}{4ex}



%% Crea una macro que capitaliza la primera letra
\ExplSyntaxOn
\NewExpandableDocumentCommand \FirstLetterUppercase { O{} m }
  { \text_titlecase:nn {#1} {#2} }
\ExplSyntaxOff

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Create a new counter that will follow tcolorbox's numbering
%% Create a new counter that will follow tcolorbox's numbering
\newcounter{theoremCounter}[section]
\renewcommand*{\thetheoremCounter}{\noexpand\thesection.\noexpand\arabic{theoremCounter}}

\newtcolorbox[list inside=\EnvTheoremSimpleImgListingExt,list type=\EnvTheoremSimpleImgListingExt,auto counter,number within=section]%
{theorem}%
[1][]%
{
  title={#1},
  detach title,
  colback=\EnvTheoremSimpleImgBackColor,
  coltitle=\EnvTheoremSimpleImgTitleColor,
  fonttitle=\EnvTheoremSimpleImgTitleFont,
  %
  colframe=\EnvTheoremSimpleImgFrameColor,
  leftrule=\EnvTheoremSimpleImgThickness,
  toprule=\EnvTheoremSimpleImgThickness, 
  rightrule=\EnvTheoremSimpleImgThickness, 
  bottomrule=\EnvTheoremSimpleImgThickness,
  %
  left=\EnvTheoremSimpleImgLeftPadding,
  right=\EnvTheoremSimpleImgRightPadding,
  top=\EnvTheoremSimpleImgTopPadding,
  bottom=\EnvTheoremSimpleImgBottomPadding,
  %
  breakable,
  enhanced,
  arc=0mm,
  before={\vspace{\EnvTheoremSimpleImgBeforeSpace}},
  after={\vspace{\EnvTheoremSimpleImgAfterSpace}},
  code={
  \ifdefempty{\tcbtitletext}
    {
    \tcbset{list text={ \FirstLetterUppercase{\EnvTheoremSimpleImgPreTitle}  }}
    }
    {%% \tcbtitle is the title write by the user
    \tcbset{list text={#1}}
    }
  %
  \ifdefempty{\tcbtitletext}
    {
        \tcbset{before upper={\addtocounter{theoremCounter}{-1}\refstepcounter{theoremCounter}%
        \EnvTheoremSimpleImgImage
        \hspace{\EnvTheoremSimpleImgPostPic}%
        \textcolor{\EnvTheoremSimpleImgTitleColor}{\EnvTheoremSimpleImgTitleFont\EnvTheoremSimpleImgPreTitle\;\thetcbcounter:} \refstepcounter{theoremCounter}}}
    }
    {%% \tcbtitle is the title write by the user
        \tcbset{before upper={\addtocounter{theoremCounter}{-1}\refstepcounter{theoremCounter}%
        \EnvTheoremSimpleImgImage
        \hspace{\EnvTheoremSimpleImgPostPic}%
        \textcolor{\EnvTheoremSimpleImgTitleColor}{\EnvTheoremSimpleImgTitleFont\EnvTheoremSimpleImgPreTitle\;\thetcbcounter\;- \tcbtitle:} \refstepcounter{theoremCounter}}}
    }
  },
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% List of type 
%% Usar con:  \tcblistof[\section*]{\EnvTheoremSimpleImgListingExt}{Lista de frases}
%%
\titlecontents{\EnvTheoremSimpleImgListingExt}[2.00cm] %% Indentation %% left
{\EnvTheoremSimpleImgTocEntryFormat} %% Spacing and font options for sections %% above code
{\contentslabel[{\thecontentslabel}]{1.45cm}} %% Section number %% numbered-entry-format % {\thetcbcounter}%
{} %% numberless-entry-format
{\ \titlerule*[.5pc]{.}\;\color{black}\thecontentspage} %% filler-page-format 
[] %% separator



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\makeatletter
%\newcommand{\ttll@\EnvTheoremSimpleImgListingExt}{-1000}
%\makeatother
%% To next warning
%% Package titletoc Warning: Unknown TOC type EnvTheoremSimpleImgListingExt. I'll set it for you with(titletoc)                level -1000. on input line 1.
